<app-crud-grid [title]="isEditMode ? 'Editar Fornecedor' : 'Novo Fornecedor'">
  <form [formGroup]="supplierForm" (ngSubmit)="onSubmit()" class="glass-form container-fluid">
    
    <section class="form-section mb-4">
      <div class="section-header d-flex align-items-center mb-3">
        <h3 class="m-0"> <mat-icon color="primary" class="me-2">fingerprint</mat-icon> Identificação</h3>
      </div>

      <div class="type-selection-wrapper mb-3">
        <label class="d-block mb-2">Tipo de Fornecedor</label>
        <mat-radio-group formControlName="type" color="primary" class="modern-radio-group">
          <mat-radio-button value="PJ" class="me-3">Pessoa Jurídica</mat-radio-button>
          <mat-radio-button value="PF">Pessoa Física</mat-radio-button>
        </mat-radio-group>
      </div>

      <div class="row g-3">
        <div class="col-md-8">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Nome / Razão Social</mat-label>
            <input matInput formControlName="name" placeholder="Digite o nome completo">
            <mat-icon matSuffix>person</mat-icon>
          </mat-form-field>
        </div>
        
        <div class="col-md-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>{{ supplierForm.get('type')?.value === 'PF' ? 'CPF' : 'CNPJ' }}</mat-label>
            <input 
              matInput 
              formControlName="document"
              [mask]="supplierForm.get('type')?.value === 'PF' ? '000.000.000-00' : '00.000.000/0000-00'"
              placeholder="000.000.000-00">
          </mat-form-field>
        </div>
      </div>
    </section>

    <section class="form-section mb-4">
      <div class="section-header d-flex align-items-center mb-3">
        <h3 class="m-0"><mat-icon color="primary" class="me-2">contact_mail</mat-icon> Contato e Localização</h3>
      </div>

      <div class="row g-3">
        <div class="col-md-8">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>E-mail Corporativo</mat-label>
            <input matInput formControlName="email" type="email" placeholder="email@exemplo.com">
            <mat-icon matSuffix>alternate_email</mat-icon>
          </mat-form-field>
        </div>

        <div class="col-md-4">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>CEP</mat-label>
            <input 
              matInput 
              formControlName="cep" 
              (blur)="searchCep()" 
              mask="00000-000" 
              placeholder="00000-000">
            <mat-icon matSuffix>map</mat-icon>
          </mat-form-field>
        </div>
      </div>
    </section>

    @if (supplierForm.get('type')?.value === 'PF') {
      <section class="form-section mb-4 animated-section">
        <div class="section-header d-flex align-items-center mb-3">
          <h3 class="m-0"> <mat-icon color="primary" class="me-2">assignment_ind</mat-icon> Dados de Pessoa Física</h3>
        </div>

        <div class="row g-3">
          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>RG</mat-label>
              <input matInput formControlName="rg" mask="A{15}" placeholder="Apenas números e letras">
            </mat-form-field>
          </div>

          <div class="col-md-6">
            <mat-form-field appearance="outline" class="w-100">
              <mat-label>Data de Nascimento</mat-label>
              <input matInput [matDatepicker]="picker" formControlName="birthDate">
              <mat-hint>DD/MM/AAAA</mat-hint>
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>
          </div>
        </div>
      </section>
    }

    <div class="form-actions d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
      <button mat-stroked-button type="button" (click)="onCancel()">
        Cancelar
      </button>
      <button mat-flat-button color="primary" type="submit" [disabled]="supplierForm.invalid">
        <mat-icon>save</mat-icon>
        {{ isEditMode ? 'Atualizar' : 'Salvar' }} Fornecedor
      </button>
    </div>
  </form>
</app-crud-grid>